const channelData = [
  {
    title: "TRT 1",
    url:
      "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  },
  {
    title: "TRT 1",
    url:
      "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  },
  {
    title: "TRT 1",
    url:
      "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  },
  {
    title: "TRT 1",
    url: "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "TRT 1"
  },
  {
    title: "TRT 1",
    url:
      "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  },
  {
    title: "TRT 1",
    url:
      "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  },
  {
    title: "TRT 1",
    url:
      "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  },
  {
    title: "TRT 1",
    url: "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  },
  {
    title: "TRT 1",
    url:
      "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "French"
  },
  {
    title: "TRT 1",
    url: "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  },
  {
    title: "TRT 1",
    url: "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  },
  {
    title: "TRT 1",
    url:
      "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  },
  {
    title: "TRT 1",
    url:
      "https:https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  },
  {
    title: "TRT 1",
    url:
      "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  },
  {
    title: "TRT 1",
    url:
      "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  },
  {
    title: "TRT 1",
    url: "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  },
  {
    title: "TRT 1",
    url:
      "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  },
  {
    title: "TRT 1",
    url: "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  },
  {
    title: "TRT 1",
    url:
      "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  },
  {
    title: "TRT 1",
    url:
      "https://ddc75c8a6akqr.cloudfront.net/v1/master/80dbfc318ab6b980679b32095ba497236de6d2f9/TRT-1/master.m3u8",
    image: "https://od.lk/s/OTFfMjc2OTA4OTZf/Yeniiii.png",
    language: "ULUSAL"
  }
];

const channelList = document.querySelector(".channel-list");
channelData.forEach((channel) => {
  const markup = `<li class="channel">
      <div class="handle">â˜°</div>
      <button class="play-channel" title="${channel.title}" data-m3u8="${channel.url}">
        <img class="channel-poster" src="${channel.image}">
      </button>
      <div class="channel-info">
        <div class="channel-title">${channel.title}</div>
        <div class="channel-language">${channel.language}</div>
       </div>
    </li>`;
  channelList.insertAdjacentHTML("beforeend", markup);
});

const video = document.querySelector("#player");
const channelPlays = document.querySelectorAll(".play-channel");
const channels = document.querySelectorAll(".channel");
const nowPlayingTitle = document.querySelector("#channel-playing");

const sortable = Sortable.create(channelList);

function loadStream(channelPlay) {
  channels.forEach((channel) => {
    channel.dataset.playing = "false";
  });
  const url = channelPlay.dataset.m3u8;
  const parent = channelPlay.closest("li");
  const title = parent.querySelector(".channel-title").textContent;
  parent.dataset.playing = "true";
  if (Hls.isSupported()) {
    const hls = new Hls();
    hls.loadSource(url);
    hls.attachMedia(video);
    hls.on(Hls.Events.MANIFEST_PARSED, () => {
      video.play();
      nowPlayingTitle.textContent = title;
    });
  }
}

channelPlays.forEach((channelPlay) => {
  channelPlay.addEventListener("click", (e) => {
    loadStream(channelPlay);
  });
});